{
	"name": "DeltaToDataverse",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"linkedService": {
						"referenceName": "DeltaLake",
						"type": "LinkedServiceReference"
					},
					"name": "AccountDeltaInput"
				},
				{
					"linkedService": {
						"referenceName": "DeltaLake",
						"type": "LinkedServiceReference"
					},
					"name": "ContactDeltaInput"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "DynamicsDataverseEntity",
						"type": "DatasetReference"
					},
					"name": "dataverseAccountEmailsTableOut"
				}
			],
			"transformations": [
				{
					"name": "accountemails"
				},
				{
					"name": "selectAttributes"
				}
			],
			"scriptLines": [
				"source(output(",
				"          Id as string,",
				"          SinkCreatedOn as timestamp,",
				"          SinkModifiedOn as timestamp,",
				"          statecode as long,",
				"          statuscode as long,",
				"          address1_addresstypecode as long,",
				"          address1_shippingmethodcode as long,",
				"          paymenttermscode as long,",
				"          accountcategorycode as long,",
				"          address1_freighttermscode as long,",
				"          accountratingcode as long,",
				"          preferredappointmenttimecode as long,",
				"          accountclassificationcode as long,",
				"          customertypecode as long,",
				"          ownershipcode as long,",
				"          preferredcontactmethodcode as long,",
				"          territorycode as long,",
				"          industrycode as long,",
				"          businesstypecode as long,",
				"          shippingmethodcode as long,",
				"          address2_addresstypecode as long,",
				"          customersizecode as long,",
				"          address2_shippingmethodcode as long,",
				"          preferredappointmentdaycode as long,",
				"          address2_freighttermscode as long,",
				"          msdyn_gdproptout as boolean,",
				"          donotpostalmail as boolean,",
				"          donotsendmm as boolean,",
				"          creditonhold as boolean,",
				"          donotbulkpostalmail as boolean,",
				"          isprivate as boolean,",
				"          donotbulkemail as boolean,",
				"          donotfax as boolean,",
				"          donotemail as boolean,",
				"          marketingonly as boolean,",
				"          followemail as boolean,",
				"          merged as boolean,",
				"          donotphone as boolean,",
				"          participatesinworkflow as boolean,",
				"          slaid as string,",
				"          slaid_entitytype as string,",
				"          transactioncurrencyid as string,",
				"          transactioncurrencyid_entitytype as string,",
				"          createdbyexternalparty as string,",
				"          createdbyexternalparty_entitytype as string,",
				"          slainvokedid as string,",
				"          slainvokedid_entitytype as string,",
				"          originatingleadid as string,",
				"          originatingleadid_entitytype as string,",
				"          territoryid as string,",
				"          territoryid_entitytype as string,",
				"          preferredserviceid as string,",
				"          preferredserviceid_entitytype as string,",
				"          primarycontactid as string,",
				"          primarycontactid_entitytype as string,",
				"          parentaccountid as string,",
				"          parentaccountid_entitytype as string,",
				"          owningbusinessunit as string,",
				"          owningbusinessunit_entitytype as string,",
				"          modifiedby as string,",
				"          modifiedby_entitytype as string,",
				"          modifiedonbehalfby as string,",
				"          modifiedonbehalfby_entitytype as string,",
				"          owninguser as string,",
				"          owninguser_entitytype as string,",
				"          owningteam as string,",
				"          owningteam_entitytype as string,",
				"          preferredequipmentid as string,",
				"          preferredequipmentid_entitytype as string,",
				"          createdonbehalfby as string,",
				"          createdonbehalfby_entitytype as string,",
				"          masterid as string,",
				"          masterid_entitytype as string,",
				"          modifiedbyexternalparty as string,",
				"          modifiedbyexternalparty_entitytype as string,",
				"          defaultpricelevelid as string,",
				"          defaultpricelevelid_entitytype as string,",
				"          msdyn_accountkpiid as string,",
				"          msdyn_accountkpiid_entitytype as string,",
				"          createdby as string,",
				"          createdby_entitytype as string,",
				"          preferredsystemuserid as string,",
				"          preferredsystemuserid_entitytype as string,",
				"          ownerid as string,",
				"          ownerid_entitytype as string,",
				"          aging90 as decimal(18,2),",
				"          aging30 as decimal(18,2),",
				"          openrevenue as decimal(18,2),",
				"          aging60_base as decimal(18,2),",
				"          creditlimit as decimal(18,2),",
				"          revenue as decimal(18,2),",
				"          marketcap as decimal(18,2),",
				"          openrevenue_base as decimal(18,2),",
				"          aging60 as decimal(18,2),",
				"          creditlimit_base as decimal(18,2),",
				"          revenue_base as decimal(18,2),",
				"          aging90_base as decimal(18,2),",
				"          marketcap_base as decimal(18,2),",
				"          aging30_base as decimal(18,2),",
				"          emailaddress3 as string,",
				"          emailaddress2 as string,",
				"          emailaddress1 as string,",
				"          masteraccountidyominame as string,",
				"          address1_city as string,",
				"          modifiedon as timestamp,",
				"          overriddencreatedon as timestamp,",
				"          websiteurl as string,",
				"          address1_longitude as double,",
				"          createdbyexternalpartyname as string,",
				"          sharesoutstanding as long,",
				"          transactioncurrencyidname as string,",
				"          yominame as string,",
				"          preferredsystemuseridyominame as string,",
				"          opendeals_date as timestamp,",
				"          modifiedbyexternalpartyyominame as string,",
				"          masteraccountidname as string,",
				"          preferredsystemuseridname as string,",
				"          address2_stateorprovince as string,",
				"          address2_country as string,",
				"          address2_line2 as string,",
				"          address1_line3 as string,",
				"          onholdtime as long,",
				"          owningbusinessunitname as string,",
				"          originatingleadidname as string,",
				"          parentaccountidname as string,",
				"          address1_utcoffset as long,",
				"          numberofemployees as long,",
				"          modifiedbyexternalpartyname as string,",
				"          exchangerate as decimal(18,2),",
				"          address2_county as string,",
				"          telephone3 as string,",
				"          address2_city as string,",
				"          address2_latitude as double,",
				"          createdon as timestamp,",
				"          address1_composite as string,",
				"          opendeals_state as long,",
				"          address2_postalcode as string,",
				"          lastusedincampaign as timestamp,",
				"          processid as string,",
				"          owneridyominame as string,",
				"          entityimage_url as string,",
				"          teamsfollowed as long,",
				"          address2_line3 as string,",
				"          description as string,",
				"          timezoneruleversionnumber as long,",
				"          address1_county as string,",
				"          createdbyname as string,",
				"          address1_line1 as string,",
				"          address2_postofficebox as string,",
				"          address2_telephone1 as string,",
				"          address2_telephone2 as string,",
				"          address2_telephone3 as string,",
				"          originatingleadidyominame as string,",
				"          preferredequipmentidname as string,",
				"          address1_addressid as string,",
				"          traversedpath as string,",
				"          territoryidname as string,",
				"          address1_telephone2 as string,",
				"          createdonbehalfbyname as string,",
				"          address2_name as string,",
				"          openrevenue_state as long,",
				"          primarysatoriid as string,",
				"          name as string,",
				"          entityimageid as string,",
				"          timespentbymeonemailandmeetings as string,",
				"          primarytwitterid as string,",
				"          owneridname as string,",
				"          entityimage_timestamp as long,",
				"          createdonbehalfbyyominame as string,",
				"          address2_composite as string,",
				"          address1_country as string,",
				"          address1_stateorprovince as string,",
				"          preferredserviceidname as string,",
				"          modifiedonbehalfbyname as string,",
				"          createdbyexternalpartyyominame as string,",
				"          address2_line1 as string,",
				"          address1_telephone1 as string,",
				"          primarycontactidname as string,",
				"          address1_telephone3 as string,",
				"          address1_postofficebox as string,",
				"          slainvokedidname as string,",
				"          fax as string,",
				"          sic as string,",
				"          address2_utcoffset as long,",
				"          stageid as string,",
				"          accountnumber as string,",
				"          address2_fax as string,",
				"          owneridtype as string,",
				"          address2_longitude as double,",
				"          ftpsiteurl as string,",
				"          address1_primarycontactname as string,",
				"          modifiedbyyominame as string,",
				"          lastonholdtime as timestamp,",
				"          address1_line2 as string,",
				"          modifiedonbehalfbyyominame as string,",
				"          openrevenue_date as timestamp,",
				"          address2_upszone as string,",
				"          address1_postalcode as string,",
				"          tickersymbol as string,",
				"          utcconversiontimezonecode as long,",
				"          defaultpricelevelidname as string,",
				"          stockexchange as string,",
				"          importsequencenumber as long,",
				"          msdyn_accountkpiidname as string,",
				"          telephone2 as string,",
				"          versionnumber as long,",
				"          accountid as string,",
				"          telephone1 as string,",
				"          address1_name as string,",
				"          address1_fax as string,",
				"          address1_latitude as double,",
				"          primarycontactidyominame as string,",
				"          modifiedbyname as string,",
				"          createdbyyominame as string,",
				"          address1_upszone as string,",
				"          address2_addressid as string,",
				"          slaname as string,",
				"          parentaccountidyominame as string,",
				"          address2_primarycontactname as string,",
				"          opendeals as long",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: true,",
				"     format: 'delta',",
				"     fileSystem: 'delta',",
				"     folderPath: 'Account') ~> AccountDeltaInput",
				"source(output(",
				"          Id as string,",
				"          SinkCreatedOn as timestamp,",
				"          SinkModifiedOn as timestamp,",
				"          statecode as long,",
				"          statuscode as long,",
				"          address3_addresstypecode as long,",
				"          address1_addresstypecode as long,",
				"          address1_freighttermscode as long,",
				"          address1_shippingmethodcode as long,",
				"          paymenttermscode as long,",
				"          gendercode as long,",
				"          preferredappointmenttimecode as long,",
				"          customertypecode as long,",
				"          customersizecode as long,",
				"          preferredcontactmethodcode as long,",
				"          address2_freighttermscode as long,",
				"          educationcode as long,",
				"          address3_freighttermscode as long,",
				"          address3_shippingmethodcode as long,",
				"          accountrolecode as long,",
				"          address2_addresstypecode as long,",
				"          preferredappointmentdaycode as long,",
				"          haschildrencode as long,",
				"          familystatuscode as long,",
				"          address2_shippingmethodcode as long,",
				"          leadsourcecode as long,",
				"          shippingmethodcode as long,",
				"          territorycode as long,",
				"          msdyn_orgchangestatus as long,",
				"          donotpostalmail as boolean,",
				"          donotsendmm as boolean,",
				"          creditonhold as boolean,",
				"          donotbulkpostalmail as boolean,",
				"          isprivate as boolean,",
				"          donotbulkemail as boolean,",
				"          donotfax as boolean,",
				"          isautocreate as boolean,",
				"          donotemail as boolean,",
				"          marketingonly as boolean,",
				"          isbackofficecustomer as boolean,",
				"          participatesinworkflow as boolean,",
				"          merged as boolean,",
				"          donotphone as boolean,",
				"          followemail as boolean,",
				"          msdyn_gdproptout as boolean,",
				"          createdbyexternalparty as string,",
				"          createdbyexternalparty_entitytype as string,",
				"          owningbusinessunit as string,",
				"          owningbusinessunit_entitytype as string,",
				"          modifiedonbehalfby as string,",
				"          modifiedonbehalfby_entitytype as string,",
				"          slaid as string,",
				"          slaid_entitytype as string,",
				"          preferredserviceid as string,",
				"          preferredserviceid_entitytype as string,",
				"          parentcontactid as string,",
				"          parentcontactid_entitytype as string,",
				"          preferredequipmentid as string,",
				"          preferredequipmentid_entitytype as string,",
				"          createdonbehalfby as string,",
				"          createdonbehalfby_entitytype as string,",
				"          msdyn_contactkpiid as string,",
				"          msdyn_contactkpiid_entitytype as string,",
				"          modifiedby as string,",
				"          modifiedby_entitytype as string,",
				"          defaultpricelevelid as string,",
				"          defaultpricelevelid_entitytype as string,",
				"          owninguser as string,",
				"          owninguser_entitytype as string,",
				"          originatingleadid as string,",
				"          originatingleadid_entitytype as string,",
				"          owningteam as string,",
				"          owningteam_entitytype as string,",
				"          slainvokedid as string,",
				"          slainvokedid_entitytype as string,",
				"          transactioncurrencyid as string,",
				"          transactioncurrencyid_entitytype as string,",
				"          masterid as string,",
				"          masterid_entitytype as string,",
				"          modifiedbyexternalparty as string,",
				"          modifiedbyexternalparty_entitytype as string,",
				"          accountid as string,",
				"          accountid_entitytype as string,",
				"          createdby as string,",
				"          createdby_entitytype as string,",
				"          preferredsystemuserid as string,",
				"          preferredsystemuserid_entitytype as string,",
				"          ownerid as string,",
				"          ownerid_entitytype as string,",
				"          parentcustomerid as string,",
				"          parentcustomerid_entitytype as string,",
				"          aging90 as decimal(18,2),",
				"          aging30 as decimal(18,2),",
				"          aging60_base as decimal(18,2),",
				"          creditlimit as decimal(18,2),",
				"          annualincome_base as decimal(18,2),",
				"          aging90_base as decimal(18,2),",
				"          aging60 as decimal(18,2),",
				"          annualincome as decimal(18,2),",
				"          creditlimit_base as decimal(18,2),",
				"          aging30_base as decimal(18,2),",
				"          emailaddress3 as string,",
				"          emailaddress2 as string,",
				"          emailaddress1 as string,",
				"          address1_city as string,",
				"          address3_line1 as string,",
				"          address1_line1 as string,",
				"          address1_longitude as double,",
				"          modifiedon as timestamp,",
				"          overriddencreatedon as timestamp,",
				"          yomilastname as string,",
				"          yomifirstname as string,",
				"          yomifullname as string,",
				"          createdbyexternalpartyname as string,",
				"          address3_line2 as string,",
				"          modifiedbyyominame as string,",
				"          address3_telephone1 as string,",
				"          address3_line3 as string,",
				"          transactioncurrencyidname as string,",
				"          preferredsystemuseridyominame as string,",
				"          address3_utcoffset as long,",
				"          externaluseridentifier as string,",
				"          businesscardattributes as string,",
				"          address3_primarycontactname as string,",
				"          modifiedbyexternalpartyyominame as string,",
				"          entityimage_url as string,",
				"          preferredsystemuseridname as string,",
				"          address2_stateorprovince as string,",
				"          mobilephone as string,",
				"          parentcustomeridyominame as string,",
				"          address2_country as string,",
				"          teamsfollowed as long,",
				"          address2_line2 as string,",
				"          address3_stateorprovince as string,",
				"          assistantphone as string,",
				"          onholdtime as long,",
				"          parentcontactidyominame as string,",
				"          address3_longitude as double,",
				"          address3_fax as string,",
				"          owningbusinessunitname as string,",
				"          birthdate as timestamp,",
				"          originatingleadidname as string,",
				"          address1_utcoffset as long,",
				"          managerphone as string,",
				"          employeeid as string,",
				"          versionnumber as long,",
				"          modifiedbyexternalpartyname as string,",
				"          address3_upszone as string,",
				"          telephone1 as string,",
				"          exchangerate as decimal(18,2),",
				"          address2_county as string,",
				"          telephone3 as string,",
				"          childrensnames as string,",
				"          address2_latitude as double,",
				"          createdon as timestamp,",
				"          slaname as string,",
				"          address1_composite as string,",
				"          firstname as string,",
				"          callback as string,",
				"          address2_postalcode as string,",
				"          lastusedincampaign as timestamp,",
				"          utcconversiontimezonecode as long,",
				"          processid as string,",
				"          owneridyominame as string,",
				"          governmentid as string,",
				"          address2_line3 as string,",
				"          description as string,",
				"          timezoneruleversionnumber as long,",
				"          spousesname as string,",
				"          address1_county as string,",
				"          createdbyname as string,",
				"          home2 as string,",
				"          address3_county as string,",
				"          pager as string,",
				"          address2_postofficebox as string,",
				"          address2_telephone1 as string,",
				"          address2_telephone2 as string,",
				"          address2_telephone3 as string,",
				"          originatingleadidyominame as string,",
				"          address1_addressid as string,",
				"          traversedpath as string,",
				"          websiteurl as string,",
				"          address2_name as string,",
				"          middlename as string,",
				"          address3_telephone2 as string,",
				"          entityimageid as string,",
				"          timespentbymeonemailandmeetings as string,",
				"          parentcustomeridname as string,",
				"          entityimage_timestamp as long,",
				"          owneridname as string,",
				"          createdonbehalfbyyominame as string,",
				"          address2_composite as string,",
				"          address1_country as string,",
				"          address1_stateorprovince as string,",
				"          preferredserviceidname as string,",
				"          modifiedonbehalfbyname as string,",
				"          createdonbehalfbyname as string,",
				"          address1_line3 as string,",
				"          createdbyexternalpartyyominame as string,",
				"          mastercontactidname as string,",
				"          jobtitle as string,",
				"          nickname as string,",
				"          managername as string,",
				"          address1_telephone1 as string,",
				"          address1_telephone2 as string,",
				"          address1_telephone3 as string,",
				"          contactid as string,",
				"          suffix as string,",
				"          slainvokedidname as string,",
				"          fax as string,",
				"          mastercontactidyominame as string,",
				"          assistantname as string,",
				"          yomimiddlename as string,",
				"          address3_country as string,",
				"          address2_utcoffset as long,",
				"          address2_fax as string,",
				"          owneridtype as string,",
				"          address2_longitude as double,",
				"          address3_latitude as double,",
				"          accountidname as string,",
				"          address1_primarycontactname as string,",
				"          lastonholdtime as timestamp,",
				"          address1_line2 as string,",
				"          modifiedonbehalfbyyominame as string,",
				"          address2_upszone as string,",
				"          address3_name as string,",
				"          address3_composite as string,",
				"          salutation as string,",
				"          address1_postalcode as string,",
				"          company as string,",
				"          stageid as string,",
				"          address3_telephone3 as string,",
				"          address3_postalcode as string,",
				"          defaultpricelevelidname as string,",
				"          address2_addressid as string,",
				"          msdyn_contactkpiidname as string,",
				"          preferredequipmentidname as string,",
				"          businesscard as string,",
				"          anniversary as timestamp,",
				"          importsequencenumber as long,",
				"          address2_city as string,",
				"          telephone2 as string,",
				"          subscriptionid as string,",
				"          department as string,",
				"          address3_city as string,",
				"          business2 as string,",
				"          address1_name as string,",
				"          address1_fax as string,",
				"          address1_latitude as double,",
				"          address3_postofficebox as string,",
				"          parentcustomeridtype as string,",
				"          parentcontactidname as string,",
				"          modifiedbyname as string,",
				"          createdbyyominame as string,",
				"          address2_line1 as string,",
				"          address1_upszone as string,",
				"          lastname as string,",
				"          accountidyominame as string,",
				"          ftpsiteurl as string,",
				"          numberofchildren as long,",
				"          address1_postofficebox as string,",
				"          address2_primarycontactname as string,",
				"          fullname as string,",
				"          address3_addressid as string",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: true,",
				"     format: 'delta',",
				"     fileSystem: 'delta',",
				"     folderPath: 'Contact') ~> ContactDeltaInput",
				"AccountDeltaInput, ContactDeltaInput join(AccountDeltaInput@Id == parentcustomerid,",
				"     joinType:'inner',",
				"     broadcast: 'auto')~> accountemails",
				"accountemails select(mapColumn(",
				"          account_ID = AccountDeltaInput@Id,",
				"          account_Name = name,",
				"          contact_name = fullname,",
				"          contact_email = ContactDeltaInput@emailaddress1,",
				"          donotemail = ContactDeltaInput@donotemail",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> selectAttributes",
				"selectAttributes sink(allowSchemaDrift: true,",
				"     validateSchema: true,",
				"     deletable:false,",
				"     insertable:true,",
				"     updateable:false,",
				"     upsertable:false,",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> dataverseAccountEmailsTableOut"
			]
		}
	}
}